!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).rx={})}(this,function(t){"use strict";function e(t,e="unknown"){const n=document.createElement("a");n.download=e,n.style.display="none",n.href=URL.createObjectURL(t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}function n(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}c((r=r.apply(t,e||[])).next())})}const r=(new Map).set("http",80).set("https",443).set("ssh",22).set("ftp",21);var i;!function(t){t.DataURL="readAsDataURL",t.Text="readAsText",t.BinaryString="readAsBinaryString",t.ArrayBuffer="readAsArrayBuffer"}(i||(i={}));const s=Object.assign(function(t,e={}){const{type:n,encoding:r}=Object.assign({type:i.DataURL,encoding:"UTF-8"},e);return new Promise((e,s)=>{t||s(new Error("file not exists"));const o=new FileReader;switch(o.onload=(()=>{e(o.result)}),o.onerror=(t=>{s(t)}),n){case i.DataURL:o.readAsDataURL(t);break;case i.Text:o.readAsText(t,r);break;case i.BinaryString:o.readAsBinaryString(t);break;case i.ArrayBuffer:o.readAsArrayBuffer(t)}})},{ReadType:i,DataURL:i.DataURL,Text:i.Text,BinaryString:i.BinaryString,ArrayBuffer:i.ArrayBuffer});function o(t,e){const n={"Y+|y+":t.getFullYear(),"M+":t.getMonth()+1,"D+|d+":t.getDate(),"H+|h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),"S+":t.getMilliseconds()};for(const t in n)if(new RegExp("("+t+")").test(e))if("Y+|y+"===t)e=e.replace(RegExp.$1,(""+n[t]).substr(4-RegExp.$1.length));else if("S+"===t){let r=RegExp.$1.length;r=1===r?3:r,e=e.replace(RegExp.$1,("00"+n[t]).substr((""+n[t]).length-1,r))}else{const r=Reflect.get(n,t);e=e.replace(RegExp.$1,1===RegExp.$1.length?r:("00"+r).substr((""+r).length))}return e}const a="yyyy-MM-ddThh:mm:ss.SSS",c=(t,e)=>encodeURIComponent(t)+"="+encodeURIComponent(e);function u(t){return new Promise(e=>{if("number"==typeof t)setTimeout(e,t);else if("function"==typeof t){const n=setInterval(()=>{t()&&(clearInterval(n),e())},100)}else e()})}function l(t,e){return Promise.race([t,u(e).then(()=>{throw new Error("timeout")})])}function h(t){return null==t}function f(t){return t}function d(t,e){return t instanceof Promise?t.then(e):e(t)}function p(t,e,n){return d((0,t[0])(...e),function(r){if(n(r))return r;const i=t.slice(1);return 0===i.length?r:p(i,e,n)})}class y{static and(...t){return function(...e){return p(t,e,t=>!t)}}static or(...t){return function(...e){return p(t,e,t=>t)}}static not(t){return new Proxy(t,{apply(t,e,n){return d(Reflect.apply(t,this,n),t=>!t)}})}}const g=y.and,m=y.or,w=y.not;var v;!function(t){t.forEach="forEach",t.filter="filter",t.map="map",t.flatMap="flatMap",t.sort="sort",t.reduce="reduce",t.reduceRight="reduceRight",t.findIndex="findIndex",t.find="find",t.every="every",t.some="some",t.parallel="parallel",t.serial="serial"}(v||(v={}));class b{constructor(t,e){this.type=t,this.args=e,this.type=t,this.args=e}}b.Type=v;class S{constructor(t=[]){this._arr=t}sort(t){return n(this,void 0,void 0,function*(){if(void 0===t)return new E(this._arr.sort());const e=this._arr.map((t,e)=>[t,e]);return new E(yield(yield function t(e,r){return n(this,void 0,void 0,function*(){if(e.length<=1)return e;const n=Math.floor(e.length/2),i=e[n],s=[],o=[];for(let t=0,a=e.length;t<a;t++){if(t===n)continue;const a=e[t];(yield r(a,i))<=0?s.push(a):o.push(a)}return(yield t(s,r)).concat([i]).concat(yield t(o,r))})}(e,([e],[n])=>t(e,n))).map(([t,e])=>this._arr[e]))})}find(t){return n(this,void 0,void 0,function*(){const e=yield this.findIndex(t);return-1===e?null:this._arr[e]})}every(t){return n(this,void 0,void 0,function*(){return-1===(yield this.findIndex(y.not(t)))})}some(t){return n(this,void 0,void 0,function*(){return-1!==(yield this.findIndex(t))})}parallel(){return new M(this._arr)}serial(){return new E(this._arr)}value(){return this._arr.slice()}}class E extends S{constructor(t){super(t)}forEach(t){return n(this,void 0,void 0,function*(){for(let e=0,n=this._arr.length;e<n;e++)yield t.call(this,this._arr[e],e,this)})}filter(t){return n(this,void 0,void 0,function*(){const e=new E;for(let n=0,r=this._arr.length;n<r;n++)(yield t.call(this,this._arr[n],n,this))&&e._arr.push(this._arr[n]);return e})}map(t){return n(this,void 0,void 0,function*(){const e=new E;for(let n=0,r=this._arr.length;n<r;n++)e._arr.push(yield t.call(this,this._arr[n],n,this));return e})}flatMap(t){return n(this,void 0,void 0,function*(){const e=new E;for(let n=0,r=this._arr.length;n<r;n++)e._arr.push(...yield t.call(this,this._arr[n],n,this));return e})}reduce(t,e){return n(this,void 0,void 0,function*(){for(let n=0,r=this._arr.length;n<r;n++)e=e?yield t.call(this,e,this._arr[n],n,this):this._arr[n];return e})}reduceRight(t,e){return n(this,void 0,void 0,function*(){for(let n=this._arr.length-1;n>=0;n--)e=e?yield t.apply(this,[e,this._arr[n],n,this]):this._arr[n];return e})}findIndex(t){return n(this,void 0,void 0,function*(){for(let e=0,n=this._arr.length;e<n;e++){if(yield t.call(this,this._arr[e],e,this))return e}return-1})}}class M extends S{constructor(t){super(t)}forEach(t){return n(this,void 0,void 0,function*(){yield this._all(t)})}filter(t){return n(this,void 0,void 0,function*(){const e=yield this._all(t),n=new M;for(let t=0,r=e.length;t<r;t++)e[t]&&n._arr.push(this._arr[t]);return n})}map(t){return n(this,void 0,void 0,function*(){return new M(yield this._all(t))})}flatMap(t){return n(this,void 0,void 0,function*(){const e=yield this._all(t);return new M(e.flat())})}sort(t){throw new Error("Method not implemented.")}reduce(t,e){return n(this,void 0,void 0,function*(){for(let n=0,r=this._arr.length;n<r;n++)e=e?yield t.call(this,e,this._arr[n],n,this):this._arr[n];return e})}reduceRight(t,e){return n(this,void 0,void 0,function*(){for(let n=this._arr.length-1;n>=0;n--)e=e?yield t.apply(this,[e,this._arr[n],n,this]):this._arr[n];return e})}findIndex(t){return n(this,void 0,void 0,function*(){return(yield this._all(t)).findIndex(f)})}_all(t){return n(this,void 0,void 0,function*(){return yield Promise.all(this._arr.map((e,n)=>t.apply(this,[e,n,this])))})}}class x{constructor(...t){this.length=0,this._arr=Array.from(t),this._tasks=[]}set _arr(t){this.__arr=t,this.length=this.__arr.length}get _arr(){return this.__arr}static from(t){const e=new x;return h(t)?e:(e._arr=Array.from(t),e)}filter(t){return this._addTask(new b(b.Type.filter,[t]))}map(t){return this._addTask(new b(b.Type.map,[t]))}flatMap(t){return this._addTask(new b(b.Type.flatMap,[t]))}sort(t){return this._addTask(new b(b.Type.sort,[t]))}parallel(){return this._addTask(new b(b.Type.parallel,[]))}serial(){return this._addTask(new b(b.Type.serial,[]))}forEach(t){return this._addTask(new b(b.Type.forEach,[t])).then()}some(t){return this._addTask(new b(b.Type.some,[t])).then()}every(t){return this._addTask(new b(b.Type.every,[t])).then()}find(t){return this._addTask(new b(b.Type.find,[t])).then()}findIndex(t){return this._addTask(new b(b.Type.findIndex,[t])).then()}reduce(t,e){return this._addTask(new b(b.Type.reduce,[t,e])).then()}reduceRight(t,e){return this._addTask(new b(b.Type.reduceRight,[t,e])).then()}then(t,e){return n(this,void 0,void 0,function*(){try{let n=new E(this._arr),r=this._arr;for(const e of this._tasks){if(!((n=yield Reflect.apply(Reflect.get(n,e.type),n,e.args))instanceof S))return h(t)||t(r),n;r=n.value()}return h(t)||t(r),r}catch(t){h(e)||e(t)}})}value(){return this.then()}*[Symbol.iterator](){for(const t of this._arr)yield t}_addTask(t){const e=new x(...this._arr);return e._tasks=[...this._tasks,t],e}}function R(t,e,n){return t>=e&&t<n}const _=/^(-?\d+)(.\d+)?$/,T=/^-?\d+$/,O=/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,k=/^((25[0-5]|2[0-4]\d|1?\d?\d)\.){3}(25[0-5]|2[0-4]\d|1?\d?\d)$/,P=/^0[1-9][0-9]{1,2}-[2-8][0-9]{6,7}$/,A=/^1\d{10}$/,L=/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/,I=/^\d{6}$/;class j{static isEmpty(t){return h(t)||""===t}static isBlank(t){return j.isEmpty(t)||""===t.trim()}static isFloat(t){return!h(t)&&_.test(t)}static isInteger(t){return!h(t)&&T.test(t)}static isEmail(t){return!h(t)&&O.test(t)}static isIpv4(t){return!h(t)&&k.test(t)}static isPort(t){return j.isInteger(t)&&R(parseInt(t),1,65535)}static isTelephone(t){return!h(t)&&P.test(t)}static isMobile(t){return!h(t)&&A.test(t)}static isDomain(t){return!h(t)&&L.test(t)}static isPostcode(t){return!h(t)&&I.test(t)}}const D=j;var C;!function(t){t[t.String=0]="String",t[t.Number=1]="Number",t[t.Boolean=2]="Boolean",t[t.Undefined=3]="Undefined",t[t.Null=4]="Null",t[t.Symbol=5]="Symbol",t[t.PropertyKey=6]="PropertyKey",t[t.Object=7]="Object",t[t.Array=8]="Array",t[t.Function=9]="Function",t[t.Date=10]="Date",t[t.File=11]="File",t[t.Blob=12]="Blob",t[t.Stream=13]="Stream",t[t.ArrayBuffer=14]="ArrayBuffer",t[t.ArrayBufferView=15]="ArrayBufferView",t[t.URLSearchParams=16]="URLSearchParams",t[t.FormData=17]="FormData"}(C||(C={}));class F{static getType(t){for(const e of Object.keys(C))if(j.isInteger(e)){const n=C[e];if(F["is"+n](t))return C[n]}throw new Error("无法识别的类型")}static isType(t,...e){return e.includes(F.getType(t))}static isString(t){return"string"==typeof t}static isNumber(t){return"number"==typeof t}static isBoolean(t){return"boolean"==typeof t}static isSymbol(t){return"symbol"==typeof t}static isUndefined(t){return void 0===t}static isNull(t){return null===t}static isPropertyKey(t){return F.isString(t)||F.isNumber(t)||F.isSymbol(t)}static isObject(t){return!F.isNull(t)&&!F.isUndefined(t)&&"object"==typeof t}static isArray(t){return Array.isArray(t)}static isFunction(t){return"[object Function]"===toString.call(t)}static isDate(t){return"[object Date]"===toString.call(t)}static isFile(t){return"[object File]"===toString.call(t)}static isBlob(t){return"[object Blob]"===toString.call(t)}static isStream(t){return F.isObject(t)&&F.isFunction(t.pipe)}static isArrayBuffer(t){return"[object ArrayBuffer]"===toString.call(t)}static isArrayBufferView(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}static isURLSearchParams(t){return!F.isUndefined(t)&&t instanceof URLSearchParams}static isFormData(t){return!F.isUndefined(t)&&t instanceof FormData}}function B(t,e,...n){const r=void 0===e?null:e;try{const e=t(...n);return e instanceof Promise?e.catch(()=>r):e}catch(t){return r}}function U(t){return t instanceof Function?t:function(t){return(F.isString(t)?t.split("."):[t]).reduceRight((t,e)=>(function(n){return B(()=>t(Reflect.get(n,e)))}),f)}(t)}function $(t,e,n=((t,e)=>(t.push(e),t)),r=(()=>[])){const i=U(e);return t.reduce((t,e,s,o)=>{const a=i(e,s,o);return t.has(a)||t.set(a,r()),t.set(a,n(t.get(a),e,s,o)),t},new Map)}function N(t,e,n=1){const r=[];for(let i=t;i<e;i+=n)r.push(i);return r}function z(t,e,n=f){const r=U(e),i=U(n);return t.reduce((t,e,n,s)=>t.set(r(e,n,s),i(e,n,s)),new Map)}F.Type=C;class Y{constructor(t,e,n,r){this.name=t,this.format=e,this.value=n,this.index=r}}const V=(new Map).set("year","Y{4}|Y{2}|y{4}|y{2}").set("month","M{1,2}").set("day","D{1,2}|d{1,2}").set("hour","h{1,2}").set("minute","m{1,2}").set("second","s{1,2}").set("millieSecond","S{1,3}"),J=(new Map).set("month","01").set("day","01").set("hour","00").set("minute","00").set("second","00").set("millieSecond","000"),K={1:31,3:31,5:31,7:31,8:31,10:31,12:31,4:30,6:30,9:30,11:30,2:28};function W(t,e){const n=new Date;J.set("year",n.getFullYear().toString());const r=[];for(const[t,n]of V){const i=new RegExp(n);if(i.test(e)){const n=i.exec(e)[0],s="`".repeat(n.length),o=e.indexOf(n);e=e.replace(n,s),r.push(new Y(t,"\\d".repeat(n.length),null,o))}else r.push(new Y(t,null,J.get(t),-1))}if(e=e.replace(new RegExp("`","g"),"\\d"),!new RegExp(`^${e}$`).test(t))return null;r.filter(({format:t})=>t).sort(function(t,e){return t.index-e.index}).map(e=>{const n=new RegExp(e.format).exec(t);return null!==n&&n.length>0&&(t=t.replace(n[0],""),e.value=n[0]),e}).forEach(({format:e},n)=>{const i=new RegExp(e).exec(t);null!==i&&i.length>0&&(t=t.replace(i[0],""),r[n].value=i[0])});const i=z(r,t=>t.name,t=>t.value);2===i.get("year").length&&i.set("year",J.get("year").substr(0,2).concat(i.get("year")));const s=t=>parseInt(i.get(t)),o=s("year"),a=s("month"),c=s("day"),u=s("hour"),l=s("minute"),h=s("second"),f=s("millieSecond");return R(a,1,13)&&R(c,1,Reflect.get(K,a)+(2===a&&o%4==0?1:0)+1)&&R(u,0,25)&&R(l,0,61)&&R(h,0,61)&&R(f,0,1e3)?new Date(o,a-1,c,u,l,h,f):null}function Z(t){return t.selectionStart}function q(t,e,n=e){t.focus(),t.setSelectionRange(e,n)}function H(t){return h(t)||"string"!=typeof t?t:t.toLowerCase()}let X;const Q=Object.assign(function(){return X},{init(){document.addEventListener("focus",t=>{X=t.target},!0),document.addEventListener("blur",()=>{X=null},!0)}});function G(t){return h(t)?"":t instanceof Date?t.toISOString():t.toString()}class tt{constructor(){this.classMap=new Map}static getFactory(){return new tt}register(t,e){return this.classMap.set(t,e),e}getInstance(t,...e){const n=this.classMap.get(t);return n?new n(...e):null}*[Symbol.iterator](){for(const t of this.classMap.entries())yield t}}function et(t){const e=performance.now();return d(t(),()=>performance.now()-e)}function nt(t){return h(t)||"string"!=typeof t?t:t.toUpperCase()}function rt(t){return j.isBlank(t)?null:t}function it(t,...e){const n=new Set(e);return Object.keys(t).reduce((e,r)=>(n.has(r)||Reflect.set(e,r,Reflect.get(t,r)),e),{})}class st{static dayStart(t=new Date){return new Date(`${o(t,"yyyy-MM-dd")}T00:00:00.000`)}static dayEnd(t=new Date){return new Date(`${o(t,"yyyy-MM-dd")}T23:59:59.999`)}static monthStart(t=new Date){return new Date(`${o(t,"yyyy-MM")}-01T00:00:00.000`)}static monthEnd(t=new Date){return new Date(`${o(t,"yyyy-MM")}-${function(t){const e=[[new Set([1,3,5,7,8,10,12]),30],[new Set([4,6,9,11]),30],[new Set([2]),28]],n=t.getFullYear(),r=t.getMonth()+1;return e.find(([t])=>t.has(r))[1]+(2===r&&n%4==0?1:0)}(t)}T23:59:59.999`)}static yearStart(t=new Date){return new Date(`${t.getFullYear()}-01-01T00:00:00.000`)}static yearEnd(t=new Date){return new Date(`${t.getFullYear()}-12-31T23:59:59.999`)}}const ot=st,at=864e5;class ct{constructor(t){this.date=t}year(){return this.date.getFullYear()}month(){return this.date.getMonth()}monthOfYear(){return this.date.getMonth()+1}dayOfYear(){return Math.ceil((this.date.getTime()-ot.yearStart(this.date).getTime())/at)}dayOfMonth(){return this.date.getDate()}dayOfWeek(){return this.date.getDay()}weekOfYear(){return Math.ceil(this.dayOfYear()/7)}weekOfMonth(){return Math.ceil(this.dayOfMonth()/7)}quarter(){const t=this.month();return R(t,0,3)?1:R(t,3,6)?2:R(t,6,9)?3:4}hour(){return this.date.getHours()}minute(){return this.date.getMinutes()}second(){return this.date.getSeconds()}milliSecond(){return this.date.getMilliseconds()}}function ut(t){return new ct(t)}class lt{constructor(t,e){this.start=t,this.end=e}milliSecond(){return this.end.getTime()-this.start.getTime()}second(){return Math.floor(this.milliSecond()/1e3)}minute(){return Math.floor(this.second()/60)}hour(){return Math.floor(this.minute()/60)}day(){return Math.floor(this.hour()/24)}month(){return 12*this.year()+(this.end.getMonth()-this.start.getMonth())}year(){return this.end.getFullYear()-this.start.getFullYear()}}function ht(t,e,n=f){const r=U(n),i=new Set(t.map(r)),s=new Set(e.map(r)),o=t.filter((t,...e)=>!s.has(r(t,...e))),a=e.filter((t,...e)=>!i.has(r(t,...e))),c=new Set(o.map(r));return{left:o,right:a,common:t.filter((t,...e)=>!c.has(r(t,...e)))}}const ft=ht;const dt=function*(){for(let t=0;;t++)yield t}();class pt{from(t){throw new Error("子类必须重写 from 函数")}to(t){throw new Error("子类必须重写 to 函数")}}class yt extends pt{from(t){const e=[],n=t.length;let r=0;for(let i=0;i<n;i++){const n=t.charAt(i);n>="A"&&n<="Z"&&(0!==i&&e.push(t.substring(r,i)),r=i)}return r!==t.length&&e.push(t.substring(r,t.length)),e}}class gt extends yt{to(t){return t.reduce((t,e,n)=>{const r=H(e);return t+((0===n?H:nt)(r.substring(0,1))+r.substring(1))},"")}}class mt extends yt{to(t){return t.reduce((t,e)=>{const n=H(e);return t+(nt(n.substring(0,1))+n.substring(1))},"")}}class wt extends pt{from(t){return t.split("_")}}class vt extends wt{to(t){return t.map(H).join("_")}}class bt extends wt{to(t){return t.map(nt).join("_")}}var St;(St=t.StringStyleType||(t.StringStyleType={}))[St.Camel=1]="Camel",St[St.Pascal=2]="Pascal",St[St.Snake=3]="Snake",St[St.ScreamingSnake=4]="ScreamingSnake";class Et{static getInstance(e){switch(e){case t.StringStyleType.Camel:return new gt;case t.StringStyleType.Pascal:return new mt;case t.StringStyleType.Snake:return new vt;case t.StringStyleType.ScreamingSnake:return new bt;default:throw new Error("No corresponding converter found")}}}class Mt{constructor(t,e){this.fromConverter=Et.getInstance(t),this.toConverter=Et.getInstance(e)}convert(t){return D.isEmpty(t)?t:this.toConverter.to(this.fromConverter.from(t))}}function xt(t,e=(e=>`onceOfSameParam-${t.toString()}-${JSON.stringify(e)}`)){const n=new Map,r=new Proxy(t,{apply(t,r,i){const s=e(i),o=n.get(s);return void 0!==o?o:d(Reflect.apply(t,r,i),t=>(n.set(s,t),t))}});return Object.assign(r,{origin:t,clear(...t){t.length?n.clear():t.forEach(t=>n.delete(t))}})}const Rt=xt((t,e)=>new Mt(t,e));class _t{static getConverter(t,e){return Rt(t,e)}static convert(t,e,n){return _t.getConverter(t,e).convert(n)}}function Tt(t,...e){const n=e.filter(t=>t!==Tt._);if(n.length>=t.length)return t(...n);function r(...n){const r=new Set;let i=0;const s=e.map(t=>t!==Tt._||void 0===n[i]||n[i]===Tt._?t:(r.add(i),n[i++])),o=n.filter((t,e)=>!r.has(e));return Tt(t,...s,...o)}return r._length=t.length-e.filter(t=>t!==Tt._).length,r.toString=(()=>`name: ${t.name}, args: [${e.map(t=>t.toString()).join(", ")}]`),r._curry=!0,r}Tt._=Symbol("_");class Ot{constructor(t){this.fmt=t}format(t){return h(t)?"":o(t,this.fmt)}parse(t){return D.isEmpty(t)?null:W(t,this.fmt)}strFormat(t,e){if(D.isEmpty(t))return"";return o(e?W(t,e):new Date(t),this.fmt)}}function kt(t,e,n=1){let r=0;for(let i=0,s=t.length;i<s;i++)if(e.call(t,t[i],i,t)&&++r>=n)return i;return-1}Ot.dateFormatter=new Ot("yyyy-MM-dd"),Ot.timeFormatter=new Ot("hh:mm:ss"),Ot.dateTimeFormatter=new Ot("yyyy-MM-dd hh:mm:ss");const Pt=(t,e)=>(function(...n){const r=kt(n,t=>t!==Tt._,t._length||t.length),i=Tt(t,...n);return-1===r?Pt(i,e):Tt(e,i,...n.slice(r+1))});function At(t,...e){if(F.isArray(t))return t.map(t=>At(t,...e));if(F.isDate(t))return t;if(F.isObject(t)){const n=it(t,...e);return Object.keys(n).reduce((t,n)=>{const r=Reflect.get(t,n);return Reflect.set(t,n,At(r,...e)),t},n)}return t}class Lt{constructor(t={}){Object.assign(this,t)}}const It="TimeoutInfinite";class jt{constructor({timeout:t=It,serialize:e=JSON.stringify,deserialize:n=JSON.parse}={}){this.cacheOption={timeout:t,serialize:e,deserialize:n},this.localStorage=window.localStorage,this.clearExpired()}clearExpired(){return n(this,void 0,void 0,function*(){const t=this.localStorage;(()=>{const e=t.length,n=[];for(let r=0;r<e;r++)n.push(t.key(r));return n})().filter(w(h)).map(e=>B(()=>JSON.parse(t.getItem(e)))).filter(t=>!h(t)&&h(t.cacheOption)).filter(({cacheOption:t={}})=>{const{timeStart:e,timeout:n}=t;return!h(e)&&!h(n)&&(n!==It&&Date.now()-e>n)}).forEach(({key:e})=>t.removeItem(e))})}add(t,e,n){null===this.get(t)&&this.set(t,e,n)}del(t){this.localStorage.removeItem(t)}set(t,e,n){this.localStorage.setItem(t,JSON.stringify(new Lt({key:t,val:this.cacheOption.serialize(e),cacheOption:{timeStart:Date.now(),timeout:n||this.cacheOption.timeout}})))}get(t){const e=this.localStorage.getItem(t),n=B(()=>JSON.parse(e));if(h(n)||h(n.cacheOption))return null;const[r,i,s]=[n.cacheOption.timeStart,n.cacheOption.timeout,this.cacheOption.deserialize];if(i!==It&&Date.now()-r>i)return this.del(t),null;try{return s(n.val)}catch(e){return this.del(t),null}}touch(t){const e=this.localStorage.getItem(t),n=B(()=>JSON.parse(e));if(h(n)||h(n.cacheOption))return null;const[r,i,s]=[n.cacheOption.timeStart,n.cacheOption.timeout,this.cacheOption.deserialize];if(i!==It&&Date.now()-r>i)return this.del(t),null;try{const e=s(n.val);return this.set(t,e,{timeStart:Date.now(),timeout:i}),e}catch(e){return this.del(t),null}}}const Dt=new jt;class Ct{static once(t,{identity:e=t.toString(),timeout:n}={}){const r=()=>`CacheUtil.onceOfSameParam-${e}`,i=new Proxy(t,{apply(t,e,i){const s=r(),o=Dt.get(s);return null!==o?o:d(Reflect.apply(t,e,i),t=>(Dt.set(s,t,n),t))}});return Object.assign(i,{origin:t,clear(){Dt.del(r())}})}static onceOfSameParam(t,{identity:e=t.toString(),timeout:n}={}){const r=t=>`CacheUtil.onceOfSameParam-${e}-${JSON.stringify(t)}`,i=new Proxy(t,{apply(t,e,i){const s=r(i),o=Dt.get(s);return null!==o?o:d(Reflect.apply(t,e,i),t=>(Dt.set(s,t,n),t))}});return Object.assign(i,{origin:t,clear(...t){Dt.del(r(t))}})}}const Ft=Ct;function Bt(...t){}class Ut{static cyclingDebugger(){const t=setInterval(()=>{},100);return()=>clearInterval(t)}static checkDebug(t=(()=>window.location.reload())){const e=setInterval(()=>{const e=et(()=>{});e>500&&(console.log(e),t())},1e3);return()=>clearInterval(e)}static disableConsoleOutput(){if(!window.console)return Bt;const t=z(Object.keys(console),f,t=>{const e=console[t];return console[t]=Bt,e});return()=>{for(const[e,n]of t)console[e]=n}}}const $t=Ut;class Nt{static isEmpty(t){return h(t)||!(t instanceof Array)||0===t.length}}const zt=Nt;class Yt{static join(...t){return t.reduce(Yt._join)}static _join(t,e){return t.endsWith(Yt.Separator)?(t+e).replace(Yt.Separator+Yt.Separator,Yt.Separator):e.startsWith(Yt.Separator)?t+e:t+Yt.Separator+e}}Yt.Separator="/";const Vt=Yt;var Jt;!function(t){t[t.Debug=0]="Debug",t[t.Log=1]="Log",t[t.Info=2]="Info",t[t.Warn=3]="Warn",t[t.Error=4]="Error"}(Jt||(Jt={}));const Kt={debug:Jt.Debug,log:Jt.Log,info:Jt.Info,warn:Jt.Warn,error:Jt.Error};class Wt{constructor({enable:t=!0,level:e=Jt.Log}={}){this.debug=console.debug,this.log=console.log,this.info=console.info,this.warn=console.warn,this.error=console.error,this.dir=console.dir,this.dirxml=console.dirxml,this.table=console.table,this.trace=console.trace,this.group=console.group,this.groupCollapsed=console.groupCollapsed,this.groupEnd=console.groupEnd,this.clear=console.clear,this.count=console.count,this.assert=console.assert,this.profile=console.profile,this.profileEnd=console.profileEnd,this.time=console.time,this.timeEnd=console.timeEnd,this.timeStamp=console.timeStamp,this.enable=t,this.level=e}set enable(t){Object.keys(console).forEach(e=>Reflect.set(this,e,t?console[e]:Bt))}set level(t){Object.keys(console).filter(t=>Reflect.has(Kt,t)).forEach(e=>Reflect.set(this,e,Reflect.get(Kt,e)>=t?console[e]:Bt))}}Wt.Level=Jt;const Zt=new Wt;function qt(t){return function(e){return new Proxy(e,{get:(e,n)=>Reflect.has(t,n)?Reflect.get(e,Reflect.get(t,n)):Reflect.get(e,n),set:(e,n,r)=>Reflect.has(t,n)?(Reflect.set(e,Reflect.get(t,n),r),!0):(Reflect.set(e,n,r),!0)})}}function Ht(t,{before:e=f,after:n=f,paramFn:r=((t,...e)=>[])}={}){return function t(i,...s){const o=e(i,...s),a=o.child;return zt.isEmpty(a)||(o.child=a.map(e=>t(e,...r(o,...s)))),n(o,...s)}(t)}class Xt{static bridge({id:t="id",parentId:e="parentId",child:n="child",path:r="path"}={}){return qt({id:t,parentId:e,child:n,path:r})}static bridgeTree(t,e){return Ht(t,{before:this.bridge(e)})}static bridgeList(t,e){return t.map(this.bridge(e))}}const Qt=Xt;function Gt(t,e){const n=function(t){return t instanceof Function?/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/:/^(?:toString|length)$/}(e);return Reflect.ownKeys(e).forEach(r=>{"string"==typeof r&&n.test(r)||Reflect.set(t,r,Reflect.get(e,r))}),t}const te=()=>!1;function ee(t,...e){const n=e.filter(t=>t!==ee._);if(n.length>=t.length)return t(...n);function r(...n){const r=new Set;let i=0;const s=e.map(t=>t!==ee._||void 0===n[i]||n[i]===ee._?t:(r.add(i),n[i++])),o=n.filter((t,e)=>!r.has(e));return ee(t,...s,...o)}return r._length=t.length-e.filter(t=>t!==ee._).length,r.toString=(()=>`name: ${t.name}, args: [${e.map(t=>t.toString()).join(", ")}]`),r._partial=!0,r}ee._=Symbol("_");class ne{static add(t,e,n,r){ne.listenerMap.has(t)||ne.listenerMap.set(t,[]),ne.listenerMap.get(t).push({type:e,listener:n,options:r}),t.addEventListener(e,n,r)}static remove(t,e,n,r){t.removeEventListener(e,n,r),ne.listenerMap.set(t,(ne.listenerMap.get(t)||[]).filter(t=>t.type!==e||t.listener!==n||t.options!==r))}static removeByType(t,e,n){const r=ne.listenerMap.get(t);if(void 0===r)return[];const i=$(r,t=>e===t.type&&n===t.options),s=i.get(!0)||[],o=i.get(!0)||[];return ne.listenerMap.set(t,o),s.map(e=>(t.removeEventListener(e.type,e.listener,e.options),e))}}function re(t){return(t>=10?"":"0")+t}ne.listenerMap=new Map;const ie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",se=ie.length;function oe(t){return t.split(/[\.\[]/).map(t=>/\]$/.test(t)?t.slice(0,t.length-1):t)}class ae{constructor({limit:t=1/0}={}){if(this.cache=new Map,t<=0)throw new Error("缓存的最大容量至少为 1");this.limit=t}delete(t){this.cache.delete(t)}get size(){return this.cache.size}}class ce extends ae{add(t,e){const n=this.cache.size+1-this.limit;if(n>0){[...this.cache.keys()].slice(0,n).forEach(t=>this.delete(t))}this.cache.set(t,e)}delete(t){this.cache.delete(t)}get(t){return this.cache.get(t)}get size(){return this.cache.size}has(t){return this.cache.has(t)}}class ue extends ae{constructor(){super(...arguments),this.lfuMap=new Map}add(t,e){const n=this.cache.size+1-this.limit;if(n>0){[...this.cache.keys()].sort((t,e)=>this.lfuMap.get(t)-this.lfuMap.get(e)).slice(0,n).forEach(t=>this.delete(t))}this.cache.set(t,e),this.lfuMap.set(t,0)}get(t){return this.lfuMap.set(t,this.lfuMap.get(t)+1),this.cache.get(t)}has(t){return this.lfuMap.set(t,this.lfuMap.get(t)+1),this.cache.has(t)}}class le extends ae{constructor(){super(...arguments),this.i=0,this.lruMap=new Map}get idx(){return this.i++}add(t,e){const n=this.cache.size+1-this.limit;if(n>0){const t=[...this.cache.keys()].sort((t,e)=>this.lruMap.get(t)-this.lruMap.get(e)).slice(0,n);console.log(t,this.lruMap),t.forEach(t=>this.delete(t))}this.cache.set(t,e),this.lruMap.set(t,this.idx)}get(t){return this.lruMap.set(t,this.idx),this.cache.get(t)}has(t){return this.lruMap.set(t,this.idx),this.cache.has(t)}}var he;(he=t.MemoryCacheEnum||(t.MemoryCacheEnum={}))[he.Fifo=0]="Fifo",he[he.Lfu=1]="Lfu",he[he.Lru=2]="Lru";t.AntiDebug=Ut,t.ArrayValidator=Nt,t.AsyncArray=x,t.CacheUtil=Ct,t.CombinedPredicate=y,t.DateConstants=st,t.DateFormatter=Ot,t.EventEmitter=class{constructor(){this.events=new Map}add(t,e){const n=this.events.get(t)||[];return n.push(e),this.events.set(t,n),this}remove(t,e){const n=this.events.get(t)||[];return this.events.set(t,n.filter(t=>t!==e)),this}removeByType(t){return this.events.delete(t),this}emit(t,...e){return(this.events.get(t)||[]).forEach(t=>{t(...e)}),this}listeners(t){return Object.freeze(this.events.get(t)||[])}},t.EventUtil=ne,t.FetchLimiting=class{constructor({timeout:t=1e4,limit:e=10}={}){this.timeout=t,this.limit=e,this.execCount=0,this.waitArr=[]}fetch(t,e){return n(this,void 0,void 0,function*(){return this.waitArr.push([t,e]),yield u(()=>this.execCount<this.limit),(()=>n(this,void 0,void 0,function*(){this.execCount++;const t=this.waitArr.shift();try{return yield l(fetch(t[0],t[1]),this.timeout)}finally{this.execCount--}}))()})}},t.LocalStorageCache=jt,t.Locker=class{constructor({limit:t=1,timeout:e}={}){this.limit=t,this.timeout=e||te}isLocked(){return this.limit<=0}lock(t=this.timeout){return n(this,void 0,void 0,function*(){this.isLocked()?yield Promise.race([u(()=>{const t=!this.isLocked();return t&&this.limit--,t}),u(t)]):this.limit--})}unlock(){this.limit++}},t.Logger=Wt,t.MemoryCacheFactory=class{static create(e,n){switch(e){case t.MemoryCacheEnum.Fifo:return new ce(n);case t.MemoryCacheEnum.Lfu:return new ue(n);case t.MemoryCacheEnum.Lru:return new le(n)}}},t.MicrotaskQueue=class{constructor(){this.tasks=[],this.lock=!1}add(t){return this.tasks.push(t),this.execute(),this}execute(){if(this.lock)return;this.lock=!0;const t=()=>{this.tasks.length?d(this.tasks.shift()(),()=>t()):this.lock=!1};Promise.resolve().then(t)}},t.NodeBridgeUtil=Xt,t.PathUtil=Yt,t.PubSubMachine=class{constructor(){this.subMap=new Map}pub(t,...e){const n=this.subMap.get(t);void 0!==n&&n.forEach(t=>t(...e))}sub(t,e){this.subMap.has(t)||this.subMap.set(t,[]),this.subMap.get(t).push(e)}unsub(t,e){if(void 0===e)return void this.subMap.delete(t);if(!this.subMap.has(t))return;const n=this.subMap.get(t);n.splice(n.indexOf(e),1)}},t.StateMachine=tt,t.Stopwatch=class{static format(t){const e=t%60,n=Math.floor(t/60)%60;return`${re(Math.floor(t/60/60))}:${re(n)}:${re(e)}`}static parse(t){const[,e,n,r]=/(\d+):(\d+):(\d+)/.exec(t);return 60*parseInt(e)*60+60*parseInt(n)+parseInt(r)}},t.StringStyleUtil=_t,t.StringValidator=j,t.TypeValidator=F,t.aggregation=function(t){const e=Array.from(t);class n{constructor(...t){e.forEach(([e,n=f])=>Gt(this,new e(...n(t))))}}return e.forEach(([t])=>{Gt(n.prototype,t.prototype),Gt(n,t)}),n},t.and=g,t.antiDebug=$t,t.appends=function(t,e){for(const n in e){const r=e[n];t.append(n,G(r))}return t},t.arrayDiffBy=ft,t.arrayToMap=z,t.arrayValidator=zt,t.asIterator=function(t){const e=[];for(;;){const n=t.next();if(n.done)break;e.push(n.value)}return e},t.assign=function(t,...e){return[t,...e].reduce((t,e)=>h(e)?t:Object.keys(e).reduce((t,n)=>{const r=Reflect.get(e,n);return h(r)?t:(Reflect.set(t,n,r),t)},t),{})},t.async=function(t){return new Proxy(t,{apply(t,e,r){return n(this,void 0,void 0,function*(){return yield Reflect.apply(t,e,r)})}})},t.asyncFlatMap=function(t,e){return n(this,void 0,void 0,function*(){return new x(...t).flatMap(e)})},t.asyncLimiting=function(t,{limit:e=1}={}){let r=0;const i=[];let s=!1;return new Proxy(t,{apply(t,o,a){return n(this,void 0,void 0,function*(){return i.push(a),yield u(()=>{const t=r<e;return t&&(s=!0,r++),t}),(()=>n(this,void 0,void 0,function*(){s||(r++,s=!1);const e=i.shift();try{return yield Reflect.apply(t,o,e)}finally{r--}}))()})}})},t.autoIncrement=function(){return dt.next().value},t.batch=function(t,e=0){const r=new Map,i=new Set;let s=!1;return function(...o){return n(this,void 0,void 0,function*(){if(i.add(o),yield Promise.all([u(()=>r.has(o)||!s),u(e)]),!r.has(o))try{s=!0,Array.from(yield t(Array.from(i))).forEach(([t,e])=>{r.set(t,e)})}finally{s=!1}const n=r.get(o);if(i.delete(o),r.delete(o),n instanceof Error)throw n;return n})}},t.blankToNull=rt,t.blankToNullField=function(t){return Object.keys(t).reduce((e,n)=>{const r=Reflect.get(t,n);return Reflect.set(e,n,"string"==typeof r?rt(r):r),e},{})},t.bridge=qt,t.cacheUtil=Ft,t.compare=function t(e,n){if(("number"==typeof e||e instanceof Number)&&("number"==typeof n||n instanceof Number)){const t=+e,r=+n;if(isNaN(t)&&isNaN(r))return!0;if(t===r)return 1/t==1/r;if(Math.abs(t-r)<Number.EPSILON)return!0}if(e===n)return!0;if(e instanceof RegExp&&n instanceof RegExp||("string"==typeof e||e instanceof String)&&("string"==typeof n||n instanceof String))return e.toString()===n.toString();if(e instanceof Date&&n instanceof Date)return e.getTime()===n.getTime();if(!(e instanceof Object&&n instanceof Object))return!1;if(e.prototype!==n.prototype)return!1;if(e.constructor!==n.constructor)return!1;for(const t of Object.keys(n))if(!Reflect.has(e,t))return!1;for(const r of Object.keys(e)){if(!Reflect.has(n,r))return!1;if(typeof n[r]!=typeof e[r])return!1;if(!t(e[r],n[r]))return!1}return!0},t.compatibleAsync=d,t.compose=function(...t){return t.reduceRight((t,e)=>Pt(e,t))},t.concatMap=function(t){let e=0;const r=new Set;return new Proxy(t,{apply(t,i,s){return n(this,void 0,void 0,function*(){const n=e;r.add(n),e++,yield u(()=>!r.has(n-1));const o=yield Reflect.apply(t,i,s);return r.delete(n),o})}})},t.copyText=function(t){const e=document.createElement("textarea");e.style.position="fixed",e.style.top="-1000px",document.body.appendChild(e),e.value=t,e.select();const n=document.execCommand("copy");return document.body.removeChild(e),n},t.createElByString=function(t){const e=document.createElement("div");return e.innerHTML=t,e.querySelector("*")},t.curry=Tt,t.dateBetween=function(t,e){return new lt(t,e)},t.dateConstants=ot,t.dateEnhance=ut,t.dateFormat=o,t.dateParse=W,t.debounce=function(t,e,n=null){let r,i=n;return new Proxy(e,{apply:(e,n,s)=>new Promise(o=>{r&&clearTimeout(r),r=setTimeout(()=>o(i=Reflect.apply(e,n,s)),t),setTimeout(()=>o(i),t)})})},t.deepExcludeFields=At,t.deepFreeze=function t(e){const n=e=>{F.isObject(e)&&t(e)};return F.isArray(e)?e.forEach(n):F.isObject(e)&&Object.keys(e).map(t=>Reflect.get(e,t)).forEach(n),Object.freeze(e)},t.deepProxy=function(t={},e=new String){const n={get(t,r){let i=Reflect.get(t,r);return h(i)&&(i=e),F.isFunction(i)?i.bind(t):F.isObject(i)?new Proxy(i,n):i}};return new Proxy(t,n)},t.deletes=function(t,e){return e.forEach(e=>t.delete(e)),t},t.deny=function(t){return y.not(t)},t.diffBy=ht,t.download=e,t.downloadString=function(t,r="unknown.txt"){return n(this,void 0,void 0,function*(){e(function(t){return new Blob([t],{type:"text/plain"})}(t),r)})},t.downloadUrl=function(t,e=t.substr(t.lastIndexOf("/"))){return n(this,void 0,void 0,function*(){const n=document.createElement("a");n.download=e,n.style.display="none",n.href=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)})},t.emptyAllField=function(t){return Object.keys(t).reduce((t,e)=>(Reflect.set(t,e,null),t),{})},t.emptyFunc=Bt,t.excludeFields=it,t.excludeFieldsDeep=function(t,...e){return At(t,...e)},t.extractFieldMap=function(t,e){return t.reduce((t,e)=>{for(const[n,r]of t)r.push(Reflect.get(e,n));return t},z(e,t=>t,()=>new Array))},t.fetchTimeout=l,t.fill=function t(e,n){return n<=0?"":e+t(e,n-1)},t.filterItems=function(t,e,n=f){const r=U(n),i=new Set(e.map(r));return t.filter((t,e,n)=>!i.has(r(t,e,n)))},t.findIndex=kt,t.flatMap=function(t,e=(t=>Array.from(t))){const n=U(e);return t.reduce((t,e,r,i)=>(t.push(...n(e,r,i)),t),new Array)},t.floatEquals=function(t,e){return Math.abs(t-e)<Number.EPSILON},t.formDataToArray=function(t){return Array.from(t)},t.format=function(t,e){return Object.keys(e).reduce((t,n)=>t.replace(new RegExp(`{${n}}`,"g"),G(e[n])),t)},t.get=function(t,e,n=null){F.isString(e)&&(e=oe(e));let r=t;for(const t of e)try{if(h(r=Reflect.get(r,t)))return n}catch(t){return n}return r},t.getCookies=function(){return document.cookie.split(";").reduce((t,e)=>{const[n,r]=e.split("=");return t.set(n,r),t},new Map)},t.getCursorPosition=Z,t.getCusorPostion=function(t){return Z(t)},t.getKFn=U,t.getMousePos=function(t){const e=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop;return{x:t.pageX||t.clientX+e,y:t.pageY||t.clientY+n}},t.getObjectEntries=function(t){return Reflect.ownKeys(t).map(e=>[e,Reflect.get(t,e)])},t.getObjectKeys=function(t){return h(t)?[]:Reflect.ownKeys(t)},t.getSelectText=function(){return getSelection().toString()},t.getYearWeek=function(t){return ut(t).weekOfYear()},t.groupBy=$,t.imageSize=function(t){return new Promise((e,n)=>{const r=new Image;r.addEventListener("load",function(){e({width:this.width,height:this.height})}),r.addEventListener("error",t=>{n(t.error)}),r.src=t})},t.insertText=function(t,e,n=Z(t)){const r=t.value;t.value=r.substr(0,n)+e+r.substr(n),q(t,n+e.length)},t.isBlank=function(t){return D.isBlank(t)},t.isEditable=function(t){return t&&(t.isContentEditable||["input","date","datetime","select","textarea"].includes(H(t.tagName)))},t.isEmpty=function(t){return D.isEmpty(t)},t.isFloat=function(t){return D.isFloat(t)},t.isNullOrUndefined=h,t.isNumber=function(t){return D.isInteger(t)},t.isRange=R,t.lastFocus=Q,t.listToTree=function(t,{bridge:e=f,isRoot:n=(t=>!t.parentId)}={}){const r=t.reduce((r,i)=>{const s=e(i);if(n(s))return r.push(s),r;for(const n of t){const t=e(n);if(s.parentId===t.id)return t.child=t.child||[],t.child.push(s),r}return r},[]),i=r.length;return 0===i?{}:1===i?r[0]:r},t.loadResource=function(t,e,r={}){return n(this,void 0,void 0,function*(){const n=yield fetch(t,r),i=yield n.blob();e.src=window.URL.createObjectURL(i)})},t.loadScript=function(t){return new Promise((e,n)=>{const r=document.createElement("script");r.async=!1,r.src=t,r.addEventListener("load",()=>e()),r.addEventListener("error",n),document.body.appendChild(r)})},t.loadStyle=function(t){return new Promise((e,n)=>{const r=document.createElement("link");r.rel="stylesheet",r.href=t,r.addEventListener("load",()=>e()),r.addEventListener("error",n),document.body.appendChild(r)})},t.logger=Zt,t.mapToObject=function(t){const e={};for(const[n,r]of t)Reflect.set(e,n,r);return e},t.mergeMap=function(t){let e=0;const r=new Set;return new Proxy(t,{apply(t,i,s){return n(this,void 0,void 0,function*(){const n=Reflect.apply(t,i,s),o=e;return r.add(o),e++,yield u(()=>!r.has(o-1)),r.delete(o),yield n})}})},t.nodeBridgeUtil=Qt,t.not=w,t.objToFormData=function(t){return Object.entries(t).reduce((t,[e,n])=>(n instanceof Blob?t.append(e,n):t.append(e,n&&n.toString()),t),new FormData)},t.objectToMap=function(t){return Object.keys(t).reduce((e,n)=>e.set(n,Reflect.get(t,n)),new Map)},t.once=function(t){let e,n=!0;const r=new Proxy(t,{apply:(t,r,i)=>n?(n=!1,d(Reflect.apply(t,r,i),t=>e=t)):e});return Object.assign(r,{origin:t,clear(){e=null}})},t.onceOfSameParam=xt,t.or=m,t.parseUrl=function(t){if(!t)throw new Error("Url cannot be empty");const e=new RegExp("^((\\w+)://([\\w\\.]*)(:(\\d+))?)(.*)").exec(t);if(null===e)return null;const n=e[1],i=e[2],s=e[3],o=e[5],a=e[6],c=t.substr(n.length),u=c.indexOf("?");if(-1===u){const e=c;return{url:t,website:n,protocol:i,domain:s,port:parseInt(o),href:a,accessPath:e,params:new Map}}let l=c.substr(0,u);return l.endsWith("/")&&(l=l.substring(0,l.length-1)),{url:t,website:n,protocol:i,domain:s,port:o||r.get(i)||0,href:a,accessPath:l,params:c.substr(u+1).split("&").map(t=>t.split("=")).filter(t=>""!==t[0]).reduce((t,e)=>{const n=decodeURIComponent(e[0]),r=decodeURIComponent(1===e.length?"":e[1]),i=t.get(n);return void 0===i?t.set(n,r):(Array.isArray(i)||t.set(n,[i]),void 0!==t.get(n).length&&t.get(n).push(r)),t},new Map)}},t.partial=ee,t.pathUtil=Vt,t.randomInt=function(t,e){const n=e?t:0,r=e||t;if(r<=0)throw new Error("最大值不能为 0");return n+Math.floor(Math.random()*(r-n))},t.randomStr=function(t){let e="";for(let n=0;n<t;n++)e+=ie.charAt(Math.floor(Math.random()*se));return e},t.range=N,t.readLocal=s,t.remindLeavePage=function(t=(()=>!1)){const e=e=>!t()&&(e.returnValue="请不要关闭页面","请不要关闭页面");return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},t.removeEl=function(t){const e=t.parentElement;return null==e?null:e.removeChild(t)},t.removeText=function(t,e=t.selectionStart,n=t.selectionEnd){const r=Z(t),i=t.value;t.value=i.substr(0,e)+i.substr(n,i.length),q(t,r)},t.repeatedCall=function(t,e,...n){return N(0,t).map(()=>e(...n))},t.returnItself=f,t.returnReasonableItself=function(...t){const e=t.length;return 0===e?null:1===e?t[0]:t},t.safeExec=B,t.segmentation=function(t,e){return t.reduce((t,n,r)=>(1==(r+1)%e&&t.push([]),t[t.length-1].push(n),t),new Array)},t.set=function(t,e,n){F.isString(e)&&(e=oe(e));let r=t;for(let t=0,i=e.length;t<i;t++){const s=e[t];if(t===i-1)return r[s]=n,!0;if(r=r[s],!F.isObject(r))return!1}return!1},t.setCursorPosition=q,t.setCusorPostion=function(t,e,n=e){return q(t,e,n)},t.sets=function(t,e){for(const n in e)t.set(n,e[n]);return t},t.singleModel=function(t){let e;return new Proxy(t,{construct:(t,n,r)=>(void 0===e&&(e=Reflect.construct(t,n,r)),e)})},t.sleep=function(t){const e=performance.now()+t;for(;performance.now()<=e;);},t.sortBy=function(t,e=f){const n=U(e);return function t(e,n){if(e.length<=1)return e;const r=Math.floor(e.length/2),i=e[r],s=[],o=[];for(let t=0,a=e.length;t<a;t++){if(t===r)continue;const a=e[t];n(a,i)<=0?s.push(a):o.push(a)}return t(s,n).concat([i]).concat(t(o,n))}(t.map((t,e)=>[t,e]),([e,r],[i,s])=>{const o=n(e,r,t),a=n(i,s,t);return o===a?0:o<a?-1:1}).map(([e,n])=>t[n])},t.spliceParams=function(t={}){return Array.from(Object.entries(t)).reduce((t,[e,n])=>null==n?t:(n instanceof Date?t+=c(e,o(n,a)):n instanceof Array?t+=n.map(t=>c(e,t instanceof Date?o(t,a):t)).join("&"):t+=c(e,n),t+"&"),"")},t.strToArrayBuffer=function(t){const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e<t.length;++e)n[e]=255&t.charCodeAt(e);return e},t.strToDate=function(t,e){return W(t,e)},t.stringValidator=D,t.switchMap=function(t){let e,r=0,i=0;return new Proxy(t,{apply(t,s,o){return n(this,void 0,void 0,function*(){const n=r;r++;const a=yield Reflect.apply(t,s,o);return n<i?e:(e=a,i=n,a)})}})},t.throttle=function(t,e){let n,r=0;return new Proxy(e,{apply:(e,i,s)=>new Promise(o=>{const a=Date.now();if(a-r>t)return n=Reflect.apply(e,i,s),r=a,void o(n);o(n)})})},t.timing=et,t.toLowerCase=H,t.toObject=function(t,e,n=f){const r=U(e),i=U(n);return t.reduce((t,e,n,s)=>{const o=r(e,n,s);return Reflect.has(t,o)||Reflect.set(t,o,i(e,n,s)),t},{})},t.toString=G,t.toUpperCase=nt,t.toggleClass=function(t,e){const n=Array.from(Object.values(e));return function(r){n.forEach(e=>t.classList.remove(e)),t.classList.add(e[r])}},t.treeMapping=Ht,t.treeToList=function(t,{calcPath:e=!1,bridge:n=f}={}){const r=[],i=n(t);e&&(i.path=i.id+"");const s=[i],o=new Set,a=new Map;for(let t;s.length>0;){const i=s.shift();if(void 0===(t=n(i))||o.has(i))continue;o.add(i),r.push(t);const c=t.child;if(Nt.isEmpty(c))continue;const u=c.filter(t=>!h(t)||o.has(t));s.push(...e?u.map(e=>{const r=n(e);return a.get(r.id)===r.id?r:(r.path=t.path+","+r.id,a.set(r.id,r.id),r)}):u)}return r},t.trySometime=function(t,e=1,r=(t=>!0)){return new Proxy(t,{apply(t,i,s){return n(this,void 0,void 0,function*(){let n;for(let o=0;o<e;o++)try{const e=yield Reflect.apply(t,i,s);if(r(e))return e;throw e}catch(t){n=t}throw n})}})},t.trySometimeParallel=function(t,e=1,r=(t=>!0)){return new Proxy(t,{apply(t,i,s){return n(this,void 0,void 0,function*(){return new Promise((o,a)=>n(this,void 0,void 0,function*(){let c;try{yield Promise.all(N(0,e).map(()=>n(this,void 0,void 0,function*(){try{const e=yield Reflect.apply(t,i,s);throw!0===r(e)&&o(e),e}catch(t){c=t}})))}catch(t){console.log(t)}a(c)}))})}})},t.uniqueBy=function(t,e=f){const n=U(e),r=new Set;return t.filter((t,...e)=>{const i=n(t,...e);return!r.has(i)&&(r.add(i),!0)})},t.wait=u,t.waitResource=function(t,{interval:e=100,max:n=10}={}){let r=0;return new Promise((i,s)=>{const o=setInterval(()=>{t()&&(clearInterval(o),i()),++r>=n&&(clearInterval(o),s(new Error("waitResource call timeout")))},e)})},t.watch=function(t,e,n=100){let r=t();const i=setInterval(()=>{const n=t();r!==n&&(e(n,r),r=n)},n);return()=>clearInterval(i)},t.watchEventListener=function(){class t{constructor(t,e,n,r){this.el=t,this.type=e,this.listener=n,this.useCapture=r}}const e=document.addEventListener,n=EventTarget.prototype.addEventListener,r=document.removeEventListener,i=EventTarget.prototype.removeEventListener,s=[];document.addEventListener=EventTarget.prototype.addEventListener=function(r,i,o=!1){const a=this===document?e:n;s.push(new t(this,r,i,o)),a.apply(this,arguments)},document.removeEventListenerByType=EventTarget.prototype.removeEventListenerByType=function(t){const e=this===document?r:i,n=s.map((t,e)=>t.el===this||t.type===arguments[0]?e:-1).filter(t=>-1!==t);n.forEach(t=>{const n=s[t];e.apply(n.el,[n.type,n.listener,n.useCapture])}),n.sort((t,e)=>e-t).forEach(t=>s.splice(t,1))}},t.watchObject=function(t,e){const n={get(t,e){try{return new Proxy(Reflect.get(t,e),n)}catch(n){return Reflect.get(t,e)}},set:(t,n,r)=>(e(t,n,r),Reflect.set(t,n,r))};return new Proxy(t,n)},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=rx-util.min.js.map
